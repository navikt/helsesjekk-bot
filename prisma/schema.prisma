datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client"
  output = "../src/db/generated"
  binaryTargets = ["debian-openssl-1.1.x", "darwin", "darwin-arm64", "debian-openssl-3.0.x"]
}

model Team {
  // Slack channel ID
  id              String  @id
  name            String
  active          Boolean
  postDay         Int
  postHour        Int
  revealDay       Int
  revealHour      Int
  assosiatedGroup String?
  // In the future the team can edit the questions
  questions       Json
  Asked           Asked[]
  frequency       Int     @default(1)
  weekSkew        Int     @default(0)
}

model Asked {
  id        Int      @id @default(autoincrement())
  team      Team     @relation(fields: [teamId], references: [id])
  // Slack timestamp is used as message ID in the channel
  messageTs String
  teamId    String
  timestamp DateTime
  questions Json
  revealed  Boolean
  nagged    Boolean  @default(false)
  skipped   Boolean  @default(false)
  answers   Answer[]
}

model Answer {
  answeredAt DateTime
  asked      Asked    @relation(fields: [askedId], references: [id])
  askedId    Int
  answers    Json
  // Slack user ID, only used to keep answers unique per user
  userId     String

  @@id([userId, askedId])
}
